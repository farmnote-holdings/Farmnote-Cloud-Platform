# Farmnote "パーソナライズド・タスクリスト" 仕様書 Ver. 1.0

## 1. 機能概要

本仕様書は、Farmnote Cloudの現行「Today」機能を抜本的に再設計し、AIアシスタントを活用した**「パーソナライズド・タスクリスト」機能**を定義するものである。

**【重要】本機能は単独で存在する画面ではなく、`FarmBoard再設計仕様書`で定義された、新しいFarmBoardの担当者向けビューにおけるメインコンテンツ（中核部品）として機能する。**

本機能は、**個々の担当者に最適化されたタスクリスト**を提供する一方で、**管理者向けの全体進捗ビュー（Todayフォルダ）**も提供し、あらゆる役割のユーザーを支援する。

## 2. コンセプト：静的な"予定"から、動的な"実行管理"へ

### 2.1. 現状の課題（As-Is）
現行の「Today」機能は、牧場全体のすべての予定を一つのリストに表示するため、担当者は自分に関係のない情報の中から必要なタスクを探し出す必要があり、「情報の洪水」による高い認知負荷と、タスクの見落としリスクを抱えている。

### 2.2. 目指す姿（To-Be）
本機能は、単なる「予定一覧」の提示を目的としない。**[[AI駆動型デイリーオペレーション設計書.md]]におけるPDCAサイクルの「実行（Do）」と「記録（Check）」を担う、個人のワークスペース**を実現する。
AIアシスタントを、システム全体を「自律的に動く実行管理システム」へと進化させる触媒と位置づけ、生産者一人ひとりが**「今、自分の役割において、やるべきこと」に迷わず集中できる環境**を実現する。

具体的には、**「前日の夕方に管理者がFarmBoard上で翌日の作業を割り当て、当日に担当者が本機能で実行し、終業時に管理者が進捗を確認する」という日々の業務サイクル**を円滑に回すことを目指す。

### 2.3. タスク生成の仕組み
本機能に表示されるタスクは、性質の異なる複数のパターンから生成され、AIがそれらを統合・最適化して担当者に提示する。

1.  **システムによる自動生成タスク**:
    -   **内容**: 妊娠鑑定後の分娩予定、分娩後の発情予定など、個体イベントに基づきシステムが自動生成する。
    -   **役割**: 既存のルールベースロジックが担う。
2.  **プロトコルに基づく自動生成タスク**:
    -   **内容**: ワクチンプログラムや受精卵移植プログラムなど、事前にユーザーが設定したプロトコルをトリガーとして自動生成される。
    -   **役割**: 既存のルールベースロジックが担う。
3.  **牧場長の指示に基づくタスク**:
    -   **内容**: 搾乳機の洗浄や個別の治療指示など、牧場長がFarmBoard上で割り当てたルーティン・個別タスク。
    -   **役割**: [[AI駆動型デイリーオペレーション設計書.md]]における日々の計画（Plan）の中核。
4.  **AIによる動的生成タスク**:
    -   **内容**: センサー情報の異常検知（例：「反芻時間の大幅な低下」）や外部データ（例：「熱波予報」）に基づき、AIが「いつもと違う」パターンを検知し、新たなタスクを動的に生成する。（例：「牛番号456の健康状態確認」「第3牛舎の暑熱対策強化」）
    -   **役割**: ルールベースでは捉えきれない、非定型イベントへの対応。

## 3. 主要な提供機能（ユーザーストーリー）

| ストーリーID | 役割 | 機能 | ゴール |
| :--- | :--- | :--- | :--- |
| US-01 | 担当者 | ログインするだけで、自分のその日の役割（例：乾乳担当）に関係のあるタスク（例：分娩予定、乾乳予定）だけが自動で絞り込まれて表示される。 | 自分の業務に関係のない情報を探す手間がなくなり、やるべき作業に即座に取り掛かれる。 |
| US-02 | 担当者 | 牛のそばで手が離せない状況でも、FarmBoard上のマイクボタンから「1000番、発情見つけた」と音声メモを残す。するとAIが内容を解析し、このタスクリスト上の「1000番の発情確認」タスクに自動で「発情あり」と記録される。 | 作業を中断することなく、その場でリアルタイムに活動を記録し、タスクリストを更新できる。 |
| US-03 | 担当者 | タスク完了報告時に、使用した精液名や薬品名、次の担当者への申し送りといった重要な付随情報も、まとめて音声で記録できる。（例：「...明日の朝、加藤さんに授精依頼」） | 報告のための報告作業がなくなり、口頭での引き継ぎ漏れや記録漏れがなくなる。 |
| US-04 | 担当者 | 自身のタスクリストに、Colorセンサーの異常検知など、予定外で発生した重要なタスクもリアルタイムで追加され、見逃すことがない。 | 突発的な問題にも迅速に対応でき、事故や疾病による損失を最小限に抑えられる。 |
| US-05 | 管理者 | 左メニューに新設された「Today」セクションから、「治療」「発情」といったタスク種別ごとの進捗を詳細に確認できる。 | 終業時に作業全体の進捗や遅延をひと目で把握し、翌日に持ち越すタスクの再割り当てなどをスムーズに行える。 |
| US-06 | 管理者 | 翌日の作業予定一覧で、複数のタスクのチェックボックスを選択し、担当者を一括で割り当てることができる。 | これまで一人ひとり口頭で指示していた作業割り当てを、数クリックで完了できる。 |
| US-07 | 管理者 | 「毎日の牛舎清掃」「給餌」といった、牛個体とは紐付かない定型的な農場作業を事前にスケジュール登録しておくことができる。 | 給餌や清掃などのルーティンワークが、指示漏れなく自動的にタスクリストに組み込まれる。 |


## 4. UI/UXのイメージ

### 4.1. 画面構成
- **担当者向けビュー:** FarmBoardに、その日の自分の役割に最適化されたパーソナライズド・タスクリストがメインコンテンツとして表示される。

### 4.2. カスタムリストの表示形式
- 各タスク項目には、対象の牛番号、牛群、経過日数などの基本情報に加え、活動詳細（投薬内容など）や、前の担当者からの申し送りメモも表示される。

### 4.3. 操作方法
- **完了操作:** 各個体の横にあるチェックボックスをタップすることで、簡易的にタスクを完了できる。
- **詳細な報告:** FarmBoard上のマイク/カメラボタンから音声・画像メモを残す。AIがその内容を解析し、関連するタスクに自動で紐づけて記録を完了する。

### 4.4. Todayセクション（管理者向け）
- **目的:** 管理者などの管理者が、特定の種類のタスク全体の進捗をドリルダウンして把握するために使用する。
- **構成:**
    - 左メニューに「Today」という開閉可能またはタブ切り替え可能なセクションを設ける。
    - セクション内には、「分娩」「治療」「発情」など、事前に定義された標準的な個体リストへのリンクが配置される。
    - 各リスト名には、未完了の個体件数がバッジで表示される。
- **機能:**
    - 各リストをクリックすると、該当する個体の一覧がメインエリアに表示される。
    - 個体は予定日ベースで抽出し、詳細の条件についてはフィルタによって、牛群や担当者や進捗ステータスでのさらなる絞り込みが可能。
    - **担当者の一括アサイン:** リストにはタスクごとのチェックボックスを設け、複数のタスクを選択した上で、特定担当者を一括で割り当てる機能を持つ。

## 5. 機能要件詳細

### 5.1. 役割に応じたタスクのフィルタリングと提示
- **役割:** たとえ180件のタスクがルールベースで自動生成されたとしても、それを**誰に、いつ、どのように見せるか**を最適化しなければ意味がない。AIは、その日の担当者の役割に応じて、膨大なタスクリストの中から「あなたに関係のあるタスクはこれです」と抜き出して提示する。これが本機能におけるAIの最大の価値である。
- **入力:**
    1.  担当者の役割情報（その日のシフト情報などから取得）
    2.  全タスクリスト（上記2.3で定義された4パターンのタスク）
- **処理:**
    - AIが、役割とタスク種別の関連性（例：「乾乳担当」→「分娩」「乾乳」）を判断し、担当者に関連するタスクのみをフィルタリングする。
- **出力:**
    - 担当者ごとに最適化されたタスクリスト。

### 5.2. 「音声・画像メモ」とタスクの連携
- **役割:** [[AI駆動型デイリーオペレーション設計書.md]]の「記録（Check）」を担う。担当者がFarmBoard上で残した「音声・画像メモ」をAIが解析し、本タスクリストの内容と自動で連携させる。
- **音声/画像認識:**
    - 「牛番号」「タスク名」「薬品名」「精液名」「申し送り先の人名」などの固有名詞を高い精度で認識する。
    - 画像から耳標などを読み取り、個体を特定する。
- **自然言語理解:**
    - ユーザーの自由な発話を解析し、「対象牛」「完了タスク」「活動詳細」「次のアクション（申し送り）」といった構造化データに変換する。
- **自動記録・更新:**
    - 構造化されたデータを、関連するタスクに自動で紐づけ、ステータスを更新（例：未完了→完了）したり、活動詳細として記録したりする。
- **レビュー機能との連携**: 担当者が一日の終わりに自己レビューを行う際、Todayの各タスクと、それに関連して記録された音声・画像メモが紐づいた状態で一覧表示される。これにより、担当者は文脈を追いながら効率的に記録内容を確認・修正できる。

### 5.3. 【将来構想】AIによる自動アサイン
- 将来的には、AIがタスクの内容、担当者の過去の実績や現在の負荷状況を考慮し、最適な担当者を自動で推薦する。管理者はその推薦内容を確認・承認するだけで、割り当てが完了する。

## 6. 前提条件・依存関係
- **シフト・役割管理機能:** 「誰が」「いつ」「どの役割を担当するか」をシステムが把握するための機能が別途必要となる。
- **FarmBoardとの連携:** 本機能は`FarmBoard再設計仕様書`で定義されたUIの主要コンポーネントとして動作する。
- **データ整備:** センサーデータや薬品マスタなど、AIが判断の根拠とする各種データの整備が必要。

以上
