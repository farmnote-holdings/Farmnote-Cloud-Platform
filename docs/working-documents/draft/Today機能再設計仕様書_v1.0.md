# Farmnote Cloud "パーソナライズド・タスクリスト" 仕様書 Ver. 1.0

## 1. 機能概要

本仕様書は、Farmnote Cloudの現行「Today」機能を抜本的に再設計し、AIアシスタントを活用した**「パーソナライズド・タスクリスト」機能**を定義するものである。
**本機能は、`FarmBoard再設計仕様書`で定義された、新しいFarmBoardの担当者向けビューにおけるメインコンテンツとして機能する。**
本機能は、**個々の担当者に最適化されたタスクリスト**を提供する一方で、**管理者向けの全体進捗ビュー（Todayフォルダ）**も提供し、あらゆる役割のユーザーを支援する。

## 2. コンセプト：静的な"予定"から、動的な"実行管理"へ

### 2.1. 現状の課題（As-Is）
現行の「Today」機能は、牧場全体のすべての予定を一つのリストに表示するため、担当者は自分に関係のない情報の中から必要なタスクを探し出す必要があり、「情報の洪水」による高い認知負荷と、タスクの見落としリスクを抱えている。

### 2.2. 目指す姿（To-Be）
本機能は、単なる「予定一覧」の提示を目的としない。**AIアシスタントを、システム全体を「自律的に動く実行管理システム」へと進化させる触媒**と位置づけ、生産者一人ひとりが**「今、自分の役割において、やるべきこと」に迷わず集中できる環境**を実現する。

### 2.3. AIと既存自動化ロジックの役割分担
本機能において、AIアシスタントは必ずしも全てのタスクをゼロから生成するわけではない。「分娩後の発情予定」や「プロトコルに基づくワクチンプログラム」など、**周期やルールに基づいて発生するタスクは、既存の自動化ロジックが引き続き担う。**

AIの真価が発揮されるのは、既存ルールではカバーしきれない、**より動的で、状況判断が必要な領域**である。AIは既存の自動化ロジックを基盤としつつ、以下の付加価値を提供する。

1.  **【フィルタリングと提示】:** ルールベースで自動生成された大量の「静的な予定」を、担当者のその日の役割に応じて最適化して提示する。
2.  **【実行管理】:** 「予定」が現場でどう実行されたかをトラッキングし、音声などのシンプルなUIで記録し、次のアクションへ繋げる。
3.  **【非定型イベントへの対応】:** センサー情報や外部データから「いつもと違う」パターンを検知し、新たなタスクを動的に生成する。

## 3. 主要な提供機能（ユーザーストーリー）

| ストーリーID | 役割 | 機能 | ゴール |
| :--- | :--- | :--- | :--- |
| US-01 | 担当者 | ログインするだけで、自分のその日の役割（例：乾乳担当）に関係のあるタスク（例：分娩予定、乾乳予定）だけが自動で絞り込まれて表示される。 | 自分の業務に関係のない情報を探す手間がなくなり、やるべき作業に即座に取り掛かれる。 |
| US-02 | 担当者 | 牛のそばで手が離せない状況でも、スマートフォンに話しかけるだけで、タスクの完了を報告できる。（例：「アシスタント、牛番号493、発情確認完了」） | 作業を中断したり、事務所に戻ったりすることなく、その場でリアルタイムに活動を記録できる。 |
| US-03 | 担当者 | タスク完了報告時に、使用した精液名や薬品名、次の担当者への申し送りといった重要な付随情報も、まとめて音声で記録できる。（例：「...明日の朝、加藤さんに授精依頼」） | 報告のための報告作業がなくなり、口頭での引き継ぎ漏れや記録漏れがなくなる。 |
| US-04 | 担当者 | 自身のタスクリストに、Colorセンサーの異常検知など、予定外で発生した重要なタスクもリアルタイムで追加され、見逃すことがない。 | 突発的な問題にも迅速に対応でき、事故や疾病による損失を最小限に抑えられる。 |
| US-05 | 牧場長 | 左メニューに新設された「Today」セクションから、「治療」「発情」といったタスク種別ごとの個体リストに直接アクセスし、牧場全体の進捗を詳細に確認できる。 | 個々のスタッフに状況を聞いて回らなくても、特定の作業全体の進捗や遅延をドリルダウンして把握し、ボトルネックがあればすぐに介入できる。 |

## 4. UI/UXのイメージ

### 4.1. 画面構成
- **担当者向けビュー:** FarmBoardに、その日の自分の役割に最適化されたパーソナライズド・タスクリストがメインコンテンツとして表示される。
- **管理者向けビュー:** 左メニューに「Today」セクション（フォルダ形式）を常設。管理者権限を持つユーザーは、ここから牧場全体のタスクにアクセスできる。
- リストはタスクの種別（「分娩」「治療」など）で自動的にグルーピングされ、アコーディオン形式で開閉できる。

### 4.2. タスクの表示形式
- 各タスク項目には、対象の牛番号、牛群、経過日数などの基本情報に加え、活動詳細（投薬内容など）や、前の担当者からの申し送りメモも表示される。

### 4.3. 操作方法
- **完了操作:** 各タスクの横にあるチェックボックスをタップすることで、簡易的にタスクを完了できる。
- **詳細な報告:** マイクボタンをタップして音声入力モードを起動。自然な会話で完了報告と付随情報の記録を行える。AIが発言内容を解析し、確認画面を表示した上で記録を完了する。

### 4.4. Todayセクション（管理者向け）
- **目的:** 牧場長などの管理者が、特定の種類のタスク全体の進捗をドリルダウンして把握するために使用する。
- **構成:**
    - 左メニューに「Today」という開閉可能またはタブ切り替え可能なセクションを設ける。
    - セクション内には、「分娩」「治療」「発情」など、事前に定義された標準的な個体リストへのリンクが配置される。
    - 各リスト名には、未完了の個体件数がバッジで表示される。
- **機能:**
    - 各リストをクリックすると、該当する個体の一覧がメインエリアに表示される。
    - 個体は予定日ベースで抽出し、詳細の条件についてはフィルタによって、牛群や担当者や進捗ステータスでのさらなる絞り込みが可能。

## 5. 機能要件詳細

### 5.1. 役割に応じたタスクのフィルタリングと提示
- **役割:** たとえ180件のタスクがルールベースで自動生成されたとしても、それを**誰に、いつ、どのように見せるか**を最適化しなければ意味がない。AIは、その日の担当者の役割に応じて、膨大なタスクリストの中から「あなたに関係のあるタスクはこれです」と抜き出して提示する。これが本機能におけるAIの最大の価値である。
- **入力:**
    1.  担当者の役割情報（その日のシフト情報などから取得）
    2.  全タスクリスト（既存のルールベースで自動生成された予定＋AIが動的に生成したタスク）
- **処理:**
    - AIが、役割とタスク種別の関連性（例：「乾乳担当」→「分娩」「乾乳」）を判断し、担当者に関連するタスクのみをフィルタリングする。
- **出力:**
    - 担当者ごとに最適化されたタスクリスト。

### 5.2. 静的な予定の、動的な実行管理への昇華
- **役割:** 現状のタスク自動生成は、あくまで「予定」を作るまでである。AIアシスタントは、その「予定」が**実際にどう実行されたか**をトラッキングし、音声入力などのシンプルなUIを通じて記録し、次のアクションへと繋げる部分を担う。
- **音声認識:**
    - 「アシスタント」「完了」「報告」などのキーワードで起動。
    - 「牛番号」「タスク名」「薬品名」「精液名」「申し送り先の人名」などの固有名詞を高い精度で認識する。
- **自然言語理解:**
    - ユーザーの自由な発話を解析し、「対象牛」「完了タスク」「活動詳細」「次のアクション（申し送り）」といった構造化データに変換する。
- **自動記録:**
    - 構造化されたデータを、Farmnote Cloudの活動履歴データベースの適切なフィールドにマッピングし、自動で保存する。

### 5.3. ルールベースでは捉えきれない、非定型イベントへの対応
- **役割:** 既存のルールは、「分娩したら、XX日後に発情予定」といった定型的なものに留まる。AIは、センサーデータや活動記録、外部データなどの微細な変化から、「**いつもと違う**」パターンを検知し、新たなタスクを動的に生成する。
- **トリガー:**
    - 内部データ：Colorセンサーのアラート（例：反芻時間の大幅な低下）、乳量の大幅な変動など。
    - 外部データ：気象情報（例：熱波予報）、市場価格の変動など。
- **処理:**
    - AIがトリガーとなるイベントを検知し、その影響を分析。必要に応じて新たなタスク（例：「第3牛舎の暑熱対策強化」）を生成し、関連する担当者のリストに自動で追加する。
-  **例:**
   -  Colorセンサーが「反芻時間の大幅な低下」を検知 → AIが「牛番号456の健康状態確認」タスクを生成し、担当者に即時通知。

## 6. 前提条件・依存関係
- **シフト・役割管理機能:** 「誰が」「いつ」「どの役割を担当するか」をシステムが把握するための機能が別途必要となる。
- **既存ロジックとの連携:** 分娩後やプロトコルに基づく既存のタスク自動生成エンジンとの円滑なデータ連携が必須。
- **データ整備:** センサーデータや薬品マスタなど、AIが判断の根拠とする各種データの整備が必要。

以上
